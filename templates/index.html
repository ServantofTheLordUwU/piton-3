<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Formulário + Respostas</title>
    <style>
        body { font-family: Arial; background: #f5f5f5; margin: 0; padding: 0; }
        .container { max-width: 1100px; margin: 20px auto; padding: 10px; }
        iframe { width: 100%; height: 700px; border: 1px solid #ccc; }
        table { border-collapse: collapse; width: 100%; margin-top: 16px; background: white; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #333; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Formulário Google</h2>
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfTpQ-qrpIwkoIYT5sAavtnoCa2eOojAG5xR0mfySHkXqIDSQ/viewform?embedded=true"></iframe>

        <h2>Respostas</h2>
        <table id="respostasTabela">
            <thead id="tabelaCabecalho"></thead>
            <tbody id="tabelaCorpo"></tbody>
        </table>
    </div>

    <script>
        async function carregarRespostas() {
            const res = await fetch("/respostas");
            const data = await res.json();

            const cabecalho = document.getElementById("tabelaCabecalho");
            const corpo = document.getElementById("tabelaCorpo");

            if (data.length === 0) {
                cabecalho.innerHTML = "<tr><th>Nenhuma resposta ainda</th></tr>";
                corpo.innerHTML = "";
                return;
            }

            const colunas = Object.keys(data[0]);
            cabecalho.innerHTML = "<tr>" + colunas.map(c => `<th>${c}</th>`).join('') + "</tr>";
            corpo.innerHTML = data.map(r =>
                "<tr>" + colunas.map(c => `<td>${r[c]}</td>`).join('') + "</tr>"
            ).join('');
        }

        carregarRespostas();
        setInterval(carregarRespostas, 5000);
    </script>
</body>
</html>
